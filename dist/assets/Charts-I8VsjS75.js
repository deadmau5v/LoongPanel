/*
 * 创建人： deadmau5v
 * 创建时间： 2024-0-0
 * 文件作用：
 */

import{j as r,C as G}from"./index-tED-CDpK.js";import{P as N}from"./progress-yH0H2jOw.js";import{D as a}from"./index-C7xbLzKn.js";import{R as h,r as p}from"./react-dom-D8wjeNdT.js";import{C as z}from"./index-DIeflrbH.js";import{c as C,g as A,m as D,C as R,i as j,o as L}from"./App-CzhtfASx.js";const b=["wrap","nowrap","wrap-reverse"],_=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],I=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],U=(e,t)=>{const s=t.wrap===!0?"wrap":t.wrap;return{[`${e}-wrap-${s}`]:s&&b.includes(s)}},V=(e,t)=>{const s={};return I.forEach(n=>{s[`${e}-align-${n}`]=t.align===n}),s[`${e}-align-stretch`]=!t.align&&!!t.vertical,s},B=(e,t)=>{const s={};return _.forEach(n=>{s[`${e}-justify-${n}`]=t.justify===n}),s};function T(e,t){return C(Object.assign(Object.assign(Object.assign({},U(e,t)),V(e,t)),B(e,t)))}const W=e=>{const{componentCls:t}=e;return{[t]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},H=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},J=e=>{const{componentCls:t}=e,s={};return b.forEach(n=>{s[`${t}-wrap-${n}`]={flexWrap:n}}),s},X=e=>{const{componentCls:t}=e,s={};return I.forEach(n=>{s[`${t}-align-${n}`]={alignItems:n}}),s},q=e=>{const{componentCls:t}=e,s={};return _.forEach(n=>{s[`${t}-justify-${n}`]={justifyContent:n}}),s},Q=()=>({}),Y=A("Flex",e=>{const{paddingXS:t,padding:s,paddingLG:n}=e,l=D(e,{flexGapSM:t,flexGap:s,flexGapLG:n});return[W(l),H(l),J(l),X(l),q(l)]},Q,{resetStyle:!1});var Z=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(s[n[l]]=e[n[l]]);return s};const K=h.forwardRef((e,t)=>{const{prefixCls:s,rootClassName:n,className:l,style:f,flex:i,gap:c,children:v,vertical:u=!1,component:S="div"}=e,w=Z(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:o,direction:$,getPrefixCls:F}=h.useContext(R),m=F("flex",s),[P,k,M]=Y(m),O=u??(o==null?void 0:o.vertical),E=C(l,n,o==null?void 0:o.className,m,k,M,T(m,e),{[`${m}-rtl`]:$==="rtl",[`${m}-gap-${c}`]:j(c),[`${m}-vertical`]:O}),x=Object.assign(Object.assign({},o==null?void 0:o.style),f);return i&&(x.flex=i),c&&!j(c)&&(x.gap=c),P(h.createElement(S,Object.assign({ref:t,className:E,style:x},L(w,["justify","wrap","align"])),v))}),y=["B","KB","MB","GB"];function d(e,t=!0){let s=0;for(;e>=1024&&s<y.length-1;)e/=1024,s++;return e.toFixed(2)+(t?y[s]:"")}function ee(e){return r.jsxs(r.Fragment,{children:[r.jsxs(a.Item,{label:"平均负载",children:[e.average_load,"%"]}),r.jsxs(a.Item,{label:"最近1分钟",children:[e.load1m,"%"]}),r.jsxs(a.Item,{label:"最近5分钟",children:[e.load5m,"%"]}),r.jsxs(a.Item,{label:"最近15分钟",children:[e.load15m,"%"]})]})}function te(e){return r.jsxs(r.Fragment,{children:[r.jsxs(a.Item,{label:"平均负载",children:[e.cpu_usage.toFixed(2),"%"]}),r.jsxs(a.Item,{label:"核心数量",children:[e.cpu_number," * ",e.cpu_cores," Core"]}),r.jsxs(a.Item,{label:"核心频率",children:[e.cpu_mhz," MHz"]}),r.jsx(a.Item,{label:"核心架构",children:e.cpu_arch})]})}function se(e){return r.jsxs(r.Fragment,{children:[r.jsxs(a.Item,{label:"内存占用",children:[e.memory_usage,"%"]}),r.jsx(a.Item,{label:"内存容量",children:d(e.ram_total)}),r.jsxs(a.Item,{label:"内存频率",children:[e.ram_mhz," MHz"]}),r.jsx(a.Item,{label:"交换内存",children:d(e.ram_swap)})]})}function ne(e){return e.disks=e.disks.slice(0,2),r.jsxs(r.Fragment,{children:[r.jsxs(a.Item,{label:"磁盘占用",children:[e.disk_usage,"%"]}),r.jsx(a.Item,{label:"磁盘容量",children:d(e.disk_total)}),e.disks.map((t,s)=>r.jsxs(a.Item,{label:t.FileSystem,children:[d(t.UsedMemory,!1)," / ",d(t.MaxMemory)]},s))]})}function g({title:e,status:t}){let s=0,n=r.jsx(r.Fragment,{});switch(e){case"Load":s=t.average_load,n=ee(t);break;case"CPU":s=Math.floor(t.cpu_usage*100)/100,n=te(t);break;case"RAM":s=Math.floor(t.memory_usage*100)/100,n=se(t);break;case"Disk":s=Math.floor(t.disk_usage*100)/100,n=ne(t);break}return r.jsx(r.Fragment,{children:r.jsxs("div",{id:"Chart",children:[r.jsx("span",{children:e}),r.jsx(N,{type:"dashboard",percent:s,strokeColor:"#ff8383"}),r.jsx(a,{size:"small",column:1,className:"ChartDescriptions",children:n})]})})}function me(){const e=p.useContext(G),t=`${e==null?void 0:e.API_URL}/api/v1/status/system_status`,s=2e3,[n,l]=p.useState({disk_usage:0,average_load:0,memory_usage:0,cpu_usage:0,load1m:0,load5m:0,load15m:0,cpu_number:0,cpu_cores:0,cpu_mhz:0,cpu_arch:0,ram_total:0,ram_used_free:[0,0],ram_mhz:0,ram_swap:0,disk_total:0,disks:[]}),f=async()=>{const i=await fetch(t);if(i.ok){const c=await i.json();console.log(c),l(c)}};return p.useEffect(()=>{const i=setInterval(f,s);return()=>{clearInterval(i)}},[t]),p.useEffect(()=>{f()},[]),r.jsx(r.Fragment,{children:r.jsx(z,{id:"Charts",className:"card",title:"性能监控",children:r.jsxs(K,{justify:"space-evenly",align:"center",children:[r.jsx(g,{title:"Load",status:n}),r.jsx(g,{title:"CPU",status:n}),r.jsx(g,{title:"RAM",status:n}),r.jsx(g,{title:"Disk",status:n})]})})})}export{me as default};
